import{c as _,r as d,f as q,l as L,j as t,C as o,m as B,i as F,n as f}from"./index-DdXbiFkB.js";import{I as p}from"./InputBox-CRXJ9-E-.js";function O(){const u=_().state||null,[r,h]=d.useState({name:"",description:"",stock:"",price:"",materialType:"",styleType:"",color:"",categoryId:"",category:""}),[I,g]=d.useState([]),[m,$]=d.useState([]),[j,b]=d.useState([]),[y,x]=d.useState([]),[N,k]=d.useState(!1),E=q(),{sellerToken:T}=L(),w=["S","M","L","XL","XXL"],C=5,i=a=>{if(a.target.name==="category")if(a.target.value){const e=m.find(s=>a.target.value===s.category);h(s=>({...s,categoryId:e._id,[a.target.name]:a.target.value}))}else return;else h(e=>({...e,[a.target.name]:a.target.value.toLowerCase()}))},S=a=>{a.target.checked?g(e=>[...e,a.target.name]):g(e=>e.filter((s,n)=>s!==a.target.name))},v=async a=>{a.preventDefault();try{if(N){const e=new FormData;e.append("name",r.name),e.append("description",r.description),e.append("stock",r.stock),e.append("price",r.price),e.append("categoryId",r.categoryId._id),e.append("materialType",r.materialType),e.append("styleType",r.styleType),e.append("color",r.color),I.forEach((c,l)=>{e.append(`sizes[${l}]`,c)}),console.log(e),j&&(r.productImgUrls.filter(l=>y.includes(l)).forEach((l,U)=>{e.append(`productImgUrls[${U}]`,l)}),j.forEach(l=>{e.append("productImages",l)}));const s=await fetch(`http://localhost:3000/api/product/${r._id}`,{method:"PUT",headers:{Authorization:`Bearer ${T}`},body:e}),n=await s.json();s.status===200&&(h({name:"",description:"",stock:"",price:"",materialType:"",styleType:"",color:"",categoryId:"",category:""}),x([]),b([]),g([]),k(!1),f.success(`${n.message}`))}else{const e=new FormData;e.append("name",r.name),e.append("description",r.description),e.append("stock",r.stock),e.append("price",r.price),e.append("categoryId",r.categoryId),e.append("materialType",r.materialType),e.append("styleType",r.styleType),e.append("color",r.color),I.forEach((c,l)=>{e.append(`sizes[${l}]`,c)}),j.forEach(c=>{e.append("productImages",c)});const s=await fetch("http://localhost:3000/api/product",{method:"POST",headers:{Authorization:`Bearer ${T}`},body:e}),n=await s.json();s.status===201&&(h({name:"",description:"",stock:"",price:"",materialType:"",styleType:"",color:"",categoryId:"",category:""}),x([]),b([]),g([]),f.success(`${n.message}`))}}catch(e){f.error(`${e}`)}},z=a=>{const e=a.target.files,s=Array.from(e);if(j.length+e.length>C){alert("can only add 5 images");return}y.length+e.length<C&&alert("add five images for product "),b(c=>[...c,...e]);const n=s.map(c=>URL.createObjectURL(c));x(c=>[...c,...n])},D=a=>{b(e=>e.filter((s,n)=>n!==a)),x(e=>e.filter((s,n)=>n!==a))};d.useEffect(()=>{(async()=>{try{const e=await fetch("http://localhost:3000/api/category"),{categoryValue:s}=await e.json();s&&$(s)}catch(e){console.log("error : ",e)}})()},[]),d.useEffect(()=>{const a=()=>{const e=m.find(s=>s._id===u.categoryId._id);h({...u,category:e.category}),g(u.sizes),x(u.productImgUrls),k(!0)};if(u&&m.length>0)a();else return},[m,u]);const P=async a=>{try{const s=await(await fetch(`http://localhost:3000/api/product/${a}`,{method:"DELETE",headers:{Authorization:`Bearer ${T}`}})).json();f.success(`${s.message}`),E("/seller-dashboard/products")}catch(e){f.error(`${e.message}`)}},A=()=>{E("/seller-dashboard/products")};return d.useEffect(()=>{window.scrollTo(0,0)},[]),t.jsx(o,{className:"admin-panel",children:t.jsxs(o,{className:"create-category create-product",children:[N?t.jsx("h1",{children:"Update Product"}):t.jsx("h1",{children:"Create Product"}),t.jsxs("form",{onSubmit:v,className:"product-form",children:[t.jsx(o,{className:"box",children:t.jsx(p,{type:"text",placeholder:"Enter product name",name:"name",value:r.name,onChange:i,required:!0})}),t.jsx(o,{className:"box",id:"textarea1",children:t.jsx("textarea",{placeholder:"Enter product description",name:"description",value:r.description,onChange:i,required:!0})}),t.jsx(o,{className:"box",children:t.jsx(p,{type:"number",placeholder:"Enter product quantity",min:10,name:"stock",value:r.stock===""?"":Number(r.stock),onChange:i,required:!0})}),t.jsx(o,{className:"box",children:t.jsx(p,{type:"number",placeholder:"Enter product price",min:0,name:"price",value:r.price===""?"":Number(r.price),onChange:i,required:!0})}),t.jsx(o,{className:"box",children:t.jsx(p,{type:"text",placeholder:"Enter product material",name:"materialType",value:r.materialType,onChange:i,required:!0})}),t.jsx(o,{className:"box",children:t.jsx(p,{type:"text",placeholder:"Enter product style",name:"styleType",value:r.styleType,onChange:i,required:!0})}),t.jsx(o,{className:"box",children:t.jsx(p,{type:"text",placeholder:"Enter product color",name:"color",value:r.color,onChange:i,required:!0})}),t.jsx(o,{className:"box",children:t.jsxs("select",{name:"category",onChange:i,value:r.category,children:[t.jsx("option",{value:"",disabled:!0,children:"select product category"}),m&&m.map((a,e)=>a.category==="banner"||a.category==="banner2"?null:t.jsx("option",{value:`${a.category}`,children:a.category},e))]})}),t.jsxs(o,{className:"sizes-con",children:[t.jsx("label",{children:"sizes"}),w.map((a,e)=>t.jsxs(o,{className:"size1",children:[t.jsx(p,{type:"checkbox",id:a,name:a,checked:I.includes(a),onChange:S,className:"checkbox"}),t.jsx("label",{htmlFor:a,className:"label",children:a})]},e))]}),t.jsx(o,{className:"upload",style:{alignSelf:"center"},children:t.jsxs("label",{children:["upload product image",t.jsx(p,{type:"file",name:"images",multiple:!0,accept:"image/*",onChange:z,disabled:y.length>=C,className:"uploadbox"})]})}),t.jsx(o,{className:"product-box",children:y&&y.map((a,e)=>t.jsxs(o,{className:"product-img",children:[t.jsx("img",{src:`${a}`},e),t.jsx(B,{onClick:()=>D(e),className:"icon"})]},e))}),N?t.jsxs(o,{className:"productBtn",children:[t.jsx("button",{type:"button",className:"delete",onClick:()=>{P(u._id)},children:"delete"}),t.jsx("button",{type:"button",className:"update",onClick:v,children:"update"}),t.jsx("button",{type:"button",className:"delete",style:{backgroundColor:"black"},onClick:A,children:"cancle"})]}):t.jsx("button",{type:"submit",children:"submit"})]}),t.jsx(F,{})]})})}export{O as default};
