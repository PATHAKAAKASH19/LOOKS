import{r as c,b as U,a as W,c as D,u as O,j as s,C as a,S as R,e as v,f as B,n as d}from"./index-DXygbHet.js";import{T as o}from"./Title-Bbl53n5L.js";import{c as J}from"./createSlug-_5_DawpL.js";import{P as q,s as F}from"./slugToStr-Bvc9roIM.js";import{u as H}from"./UserInfoContext-uXsENF6b.js";import{u as M}from"./cartContext-Cv5eQMjI.js";function Z(){const[r,N]=c.useState(null),[P,f]=c.useState(""),[u,m]=c.useState(""),[p,C]=c.useState(null),[i,k]=c.useState(null),[I,j]=c.useState(!0),[S,g]=c.useState(!1),{productName:n}=U()||"",w=W(),b=D(),{accessToken:y}=O(),{userInfo:x,setUserInfo:T}=H(),{setCartInfo:z}=M(),$=t=>{t.target.innerText===u?m(""):m(t.target.innerText)},L=t=>{f(t.target.src)},A=async()=>await fetch("https://looks.akash-pathak.xyz//api/cart/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${y}`},body:JSON.stringify({productId:r._id,quantity:1,size:u})}),_=async()=>{try{if(u){const t=await A(),e=await t.json();if(t.status===403)return w("/account/login",{state:{from:b}});e.cart!==null?(z(e.cart),d.success("Product added to the cart")):d.success("Product already added to cart ")}else d.error("Please select a size")}catch(t){console.log("error in adding item to cart",t)}},E=async t=>{try{const e=await fetch("https://looks.akash-pathak.xyz//api/user/",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${y}`},body:JSON.stringify({wishlistId:t,wishlistAction:"save"})}),l=await e.json();e.status===200&&(T(l.userData),d.success("Product added to wishlist"))}catch(e){d.error("error : ",e)}};return c.useEffect(()=>{const t=async()=>{try{if(m(""),j(!0),n){const e=F(n),h=await(await fetch(`https://looks.akash-pathak.xyz//api/product?name=${e}`)).json();h&&(f(h[0].productImgUrls[0]),N(h[0]),k(h[0].categoryId))}}catch(e){console.log("error:",e)}};n&&(console.log("aja"),t())},[n]),c.useEffect(()=>{i&&(async()=>{try{if(i){console.log(i);const l=await(await fetch(`https://looks.akash-pathak.xyz//api/product/category/${i._id}`)).json();l!==null&&C(l),j(!1)}}catch(e){console.log("error:",e)}})()},[i,n]),c.useEffect(()=>{if(x!==null&&r!==null){const t=x.wishlist.some(e=>e._id===r._id);g(!!t)}},[x,r]),c.useEffect(()=>{window.scrollTo(0,0)},[]),s.jsx(a,{className:"product-page-con",children:I?s.jsx(R,{}):s.jsxs(s.Fragment,{children:[s.jsxs(a,{className:"productPage",children:[s.jsxs(a,{className:"product-img-sec",children:[s.jsx(a,{className:"img-sub-sec1",children:r.productImgUrls.map((t,e)=>s.jsx("img",{src:t,onClick:L},e))}),s.jsx(a,{className:"img-sub-sec2",children:s.jsx("img",{src:`${P}`})})]}),s.jsxs(a,{className:"product-info-sec",children:[s.jsx("h1",{className:"name",children:r.name.toUpperCase()}),s.jsxs(a,{className:"price",children:[s.jsx(o,{title:`Inr ${r.price}`}),s.jsx("h3",{children:"incl. all taxes"})]}),s.jsxs(a,{className:"description",children:[s.jsx(o,{title:"description"}),s.jsx("h3",{children:r.description})]}),s.jsxs(a,{className:"wash-care",children:[s.jsx(o,{title:"Wash Care"}),s.jsx("h3",{children:"machine wash"})]}),s.jsxs(a,{className:"material-type",children:[s.jsx(o,{title:"Material Type"}),s.jsx("h3",{children:r.materialType})]}),s.jsxs(a,{className:"size-sec",children:[s.jsx(o,{title:"Sizes"}),s.jsx("ul",{className:"size",children:r.sizes.map((t,e)=>s.jsx("li",{className:"pointer",onClick:$,style:u===`${t}`?{backgroundColor:"grey"}:null,children:t},e))})]}),s.jsxs(a,{className:"button-box",children:[s.jsxs("button",{type:"button",className:"button1",onClick:()=>E(r._id),children:[s.jsx(v,{style:S?{color:"red",marginRight:"10px"}:{color:"white",marginRight:"10px"},size:24}),"WishList"]}),s.jsx("button",{type:"button",className:"button2",onClick:_,children:"Add to Cart"})]})]})]}),s.jsxs(a,{className:"recommendation-sec",children:[s.jsx(o,{className:"title",title:"Similar Products"}),s.jsx(a,{className:"product-column",children:p&&p.length>0?p.map(t=>{if(t._id!==r._id)return s.jsx(q,{data:t,type:"productList",route:`/product/${J(t.name)}`},t._id)}):"nothing to show"}),s.jsx(B,{})]})]})})}export{Z as default};
