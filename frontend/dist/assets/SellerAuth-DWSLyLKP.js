import{r as u,b,a as A,f as L,s as C,u as P,j as a,C as f,T as k,L as g,n as F,v as N,t as O,x as R,o as l}from"./index-Npg09nsS.js";import{F as V}from"./Form-lorMnKHK.js";function z(){var p,h;const[o,m]=u.useState({email:"",password:"",role:""}),[w,i]=u.useState({emailError:"",passwordError:"",roleError:""}),{auth:n}=b(),d=A(),E=((h=(p=L().state)==null?void 0:p.from)==null?void 0:h.pathname)||"/seller-dashboard/products",{setSellerToken:x}=C(),{setAccessToken:j}=P(),c=()=>{m({email:"",password:"",role:""}),i({emailError:"",passwordError:"",roleError:""})},S=async r=>{try{const e=await fetch("http://192.168.0.104:3000/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}),s=await e.json();e.status===401?l.error(`${s.message}`):e.status===403?l.error(`${s.message}`):e.status===200&&(x(s.accessToken),localStorage.setItem("sellerAccessToken",s.accessToken),j(""),d(`${E}`)),c()}catch(e){c(),l.error(`error : ${e}`)}},y=async r=>{try{const e=await fetch("http://192.168.0.104:3000/api/auth/signup",{method:"POST",headers:{"content-Type":"application/json"},body:JSON.stringify(o)}),s=await e.json();e.status===401?l.error(`${s.message}`):e.status===403?l.error(`${s.message}`):d("/seller/login"),c()}catch(e){c(),l.error(`error : ${e}`)}},T=(r,e,s)=>{r===!1&&i(t=>({...t,emailError:"Email must be in format: example@domain.com"})),e===!1&&i(t=>({...t,passwordError:"Password: â‰¥8 chars, A-Z, a-z, 0-9, & !@#$%^&*."})),s===!1&&i(t=>({...t,roleError:"Please select role"}))},$=async r=>{r.preventDefault();try{const e=N(o.email),s=O(o.password),t=R(o.role);e&&s&&t?n.toLowerCase()==="signup"?await y():n.toLowerCase()==="login"&&await S():T(e,s,t)}catch(e){console.log("error : ",e)}},v=r=>{m({...o,[r.target.name]:r.target.value})};return u.useEffect(()=>{window.scrollTo(0,0)},[]),a.jsxs(f,{className:n,children:[a.jsx(k,{title:`${n.toUpperCase()} AS SELLER`}),a.jsxs(f,{className:"box1",children:[a.jsx(V,{btnTitle:`${n}`,formData:o,handleInput:v,handleForm:$,errors:w,autoComplete:"true",SellerAuth:!0}),n==="signup"?a.jsxs("p",{children:["or already have an account? ",a.jsx(g,{to:"../login",children:"login"})]}):a.jsxs("p",{children:["or don't have an account? ",a.jsx(g,{to:"../signup",children:"signup"})]})]}),a.jsx(F,{})]})}export{z as default};
