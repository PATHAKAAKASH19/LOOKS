import{r as l,b as S,a as v,c as b,u as C,j as t,C as h,L as f,f as L,v as A,g as F,n}from"./index-qZzDzbZj.js";import{F as P}from"./Form-CNBle6L0.js";import{T as N}from"./Title-CTVzQ9qW.js";import{u as I}from"./SellerAuthContext-C33gG-ns.js";function H(){var p,d;const[e,m]=l.useState({email:"",password:""}),[g,c]=l.useState({emailError:"",passwordError:""}),{auth:r}=S(),u=v(),w=((d=(p=b().state)==null?void 0:p.from)==null?void 0:d.pathname)||"/",{setAccessToken:x}=C(),{setSellerToken:j}=I(),i=()=>{m({email:"",password:""}),c({emailError:"",passwordError:""})},y=async()=>{try{const s=await fetch("https://looks.akash-pathak.xyz/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),a=await s.json();s.status===401?n.error(`${a.message}`):s.status===403?n.error(`${a.message}`):s.status===200&&(x(a.accessToken),j(""),u(`${w}`)),i()}catch(s){i(),n.error(`error : ${s}`)}},E=async()=>{try{const s=await fetch("https://looks.akash-pathak.xyz/api/auth/signup",{method:"POST",headers:{"content-Type":"application/json"},body:JSON.stringify(e)}),a=await s.json();s.status===401?n.error(`${a.message}`):s.status===403?n.error(`${a.message}`):u("/account/login"),i()}catch(s){i(),n.error(`error : ${s}`)}},T=(s,a)=>{s===!1&&c(o=>({...o,emailError:"Email must be in format: example@domain.com"})),a===!1&&c(o=>({...o,passwordError:"Password: â‰¥8 chars, A-Z, a-z, 0-9, & !@#$%^&*."}))},$=async s=>{s.preventDefault();try{const a=A(e.email),o=F(e.password);a&&o?r.toLowerCase()==="signup"?await E():r.toLowerCase()==="login"&&await y():T(a,o)}catch(a){console.log("error : ",a)}},k=s=>{m({...e,[s.target.name]:s.target.value})};return l.useEffect(()=>{window.scrollTo(0,0)},[]),t.jsxs(h,{className:r,children:[t.jsx(N,{title:`${r.toUpperCase()} WITH EMAIL`}),t.jsxs(h,{className:"box1",children:[t.jsx(P,{btnTitle:`${r}`,formData:e,handleInput:k,handleForm:$,errors:g,autoComplete:"true"}),r==="signup"?t.jsxs("p",{children:["or already have an account? ",t.jsx(f,{to:"../login",children:"login"})]}):t.jsxs("p",{children:["or don't have an account? ",t.jsx(f,{to:"../signup",children:"signup"})]})]}),t.jsx(L,{})]})}export{H as default};
