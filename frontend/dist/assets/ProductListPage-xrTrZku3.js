import{r,b as k,j as e,C as n,F as T,c as R,d as v,e as A,u as O,S as _,f as z,L as V}from"./index-DlYTwukh.js";import{P as W,s as M}from"./slugToStr-D7Dzakt1.js";import{T as B}from"./Title-DENLl2rL.js";import{I as H}from"./InputBox-mZfZvA47.js";import{c as X}from"./createSlug-_5_DawpL.js";import{C as q}from"./index-T1AYsRVS.js";const D=r.forwardRef(({setSearchParams:u,isMobile:F,hideFilter:b},L)=>{const f={sizes:["S","M","L","XL","XXL"],material:["cotton","cotton blend","polyester","linen"],style:["checks","plain","printed","self-design","textured","geometric"],color:["grey","blue","brown","black","navy","purple","dark green","red","orange","light grey","light blue","green","beige","pink","olive","cream"],price:[499,999,1499,1999,899]},g={sizes:["28","30","32","34","36","40"],material:["cotton","cotton blend","polyster","linen","linen blend","poly blend"],style:["loose fit","regular fit","relaxed fit","slim fit"]},P=["trouser","jeans","joggers","shorts"],[h,p]=r.useState(f),[S,y]=r.useState({}),[m,I]=r.useState({}),{category:x}=k();r.useEffect(()=>{(()=>{P.includes(x)?p(c=>({...c,...g})):p(c=>({...c,...f}))})()},[x]);const $=(s,c)=>{s.target.checked?y(t=>({...t,[c]:[...t[c]||[],s.target.name]})):y(t=>{var i;return{...t,[c]:(i=t[c])==null?void 0:i.filter(w=>w!==s.target.name)}})};r.useEffect(()=>{if(Object.keys(S).length!==0){const s=new URLSearchParams;for(const[c,t]of Object.entries(S))t.length>0?t.forEach(i=>{s.append(`${c}`,i)}):s.delete(`${c}`);u(s)}},[S]);const j=(s,c,t)=>{I(i=>({...i,[c]:t})),s.target.scrollIntoView({behavior:"smooth"})};return r.useEffect(()=>{window.scrollTo(0,0)},[m]),e.jsx("div",{className:"filter-sec",ref:L,children:e.jsxs(n,{className:"filterBox",children:[Object.entries(h).map(([s,c])=>e.jsxs(n,{className:"Box",children:[e.jsxs(n,{className:"box-icon-con",children:[e.jsx(B,{title:s,className:"box-title"}),m[s]?e.jsx(T,{onClick:t=>j(t,s,!1)},`${s}_minus`):e.jsx(R,{onClick:t=>j(t,s,!0)},`${s}_plus`)]}),m[s]?e.jsx(n,{className:"sub-box",children:c.map((t,i)=>e.jsxs(n,{children:[e.jsx(H,{type:"checkbox",id:t,name:`${t}`,onChange:w=>$(w,s)}),e.jsx("label",{htmlFor:t,children:t})]},`${i}_${s}`))}):null]},`${s}_tfgf`)),F&&e.jsxs(n,{className:"filter-button",children:[e.jsx("button",{type:"button",onClick:b,children:"close"}),e.jsx("button",{type:"button",onClick:b,children:"apply"})]})]})})}),G=D;function ee(){const{category:u}=k(),{pathname:F}=v();r.useEffect(()=>{window.scrollTo(0,0)},[F]);const[b,L]=r.useState(""),[f,g]=r.useState(null),[P,h]=r.useState(!0),[p,S]=r.useState(window.innerWidth<700),[y,m]=r.useState(!1),[I,x]=r.useState(!1),$=r.useRef(null),[j,s]=A(),{accessToken:c,setAccessToken:t}=O();r.useEffect(()=>{const o=["topwear","bottomwear","trending"],l=async()=>{try{h(!0);const a=M(u),N=await fetch(`http://localhost:3000/api/category?category=${a}`),{categoryValue:C}=await N.json();C&&L(C[0]._id)}catch(a){console.log("error",a)}},d=async()=>{try{h(!0);const a=await fetch("http://localhost:3000/api/product/"),N=await a.json();if(a.status===200&&u!=="trending"){const C=N.products.filter(E=>E.categoryId.subCategory===u);g(C),h(!1)}else{const C=N.products.filter(E=>E.categoryId.trending);g(C),h(!1)}}catch(a){console.log("error , ",a)}};o.includes(u)?o.includes(u)&&d():l()},[u]),r.useEffect(()=>{(async()=>{try{let l;if(j&&(l=j?j.toString():null),b){const d=await fetch(`http://localhost:3000/api/product/filter?categoryId=${b}&${l}`),a=await d.json();d.status===200?(g(a),h(!1)):d.status===404&&h(!1)}}catch(l){console.log("error:",l)}})()},[j,b]),r.useEffect(()=>{const o=()=>{S(window.innerWidth<700)};return window.addEventListener("resize",o),()=>{window.removeEventListener("resize",o)}},[]);const i=()=>{m(!1)},w=o=>{g(o==="ascending"?l=>[...l].sort((d,a)=>d.price-a.price):l=>[...l].sort((d,a)=>a.price-d.price)),f&&x(!1)};return r.useEffect(()=>{!c&&localStorage.getItem("userAccessToken")&&t(localStorage.getItem("userAccessToken"))},[c,t]),e.jsx(n,{className:"product-list-container",children:P?e.jsx(_,{}):e.jsx(e.Fragment,{children:f&&f.length>0?e.jsxs(n,{className:"productList",children:[p&&!y&&e.jsxs(n,{className:"productList-icon-con",children:[e.jsxs(n,{children:[e.jsx(q,{className:"productList-icon",onClick:()=>x(o=>!o)}),e.jsx("h1",{onClick:()=>x(o=>!o),children:"SORT"})]}),e.jsx("div",{className:"line"}),e.jsxs(n,{children:[e.jsx(z,{className:"productList-icon",onClick:()=>m(o=>!o)}),e.jsx("h1",{onClick:()=>m(o=>!o),children:"FILTER"})]})]}),(!p||y)&&e.jsx(n,{className:"filterCon",children:e.jsx(G,{ref:$,isMobile:p,hideFilter:i,className:"filter",setSearchParams:s})}),p&&I&&e.jsx(n,{className:"sort-con",children:e.jsxs(n,{className:"sort",children:[e.jsx("h2",{onClick:()=>w("descending"),children:"Price : High to Low"}),e.jsx("h2",{onClick:()=>w("ascending"),children:"Price : Low to High"}),e.jsx("button",{onClick:()=>x(!1),children:"go back"})]})}),e.jsx(n,{className:"product-column",children:f.map(o=>e.jsx(W,{data:o,route:`/product/${X(o.name)}`},o._id))})]}):e.jsxs(n,{className:"product-list-error",children:[e.jsx("h2",{children:"nothing to show"}),e.jsx(V,{to:"/",className:"product-list-link",children:e.jsx("h2",{children:"Go to Home page"})})]})})})}export{ee as default};
