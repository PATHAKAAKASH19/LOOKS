import{r as n,b as E,j as e,C as i,T as v,F as T,d as z,e as X,f as A,g as R,u as M,S as _,h as O,c as V,L as W}from"./index-Dw_2fx3G.js";import{P as B,s as H}from"./slugToStr-ZFj36Q6u.js";import{C as q}from"./index-c2ORPugq.js";const D=n.forwardRef(({setSearchParams:l,isMobile:N,hideFilter:j},P)=>{const p={sizes:["S","M","L","XL","XXL"],material:["cotton","cotton blend","polyester","linen"],style:["checks","plain","printed","self-design","textured","knitted"],color:["grey","brown","black","navy blue","purple","dark green","red","orange","light grey","light blue","green","beige","pink","olive","cream","yellow","mustard","white"],price:["499","999","899","1499","1999"]},m={sizes:["S","M","L","XL","XXL"],material:["cotton","cotton blend","polyester","linen","elastane blend","poly blend"],style:["loose fit","regular fit","relaxed fit","slim fit"],color:["grey","brown","black","navy blue","purple","dark green","red","orange","light grey","light blue","green","beige","pink","olive","cream","yellow","mustard","white"],price:["499","999","899","1499","1999"]},I={sizes:["S","M","L","XL","XXL"],material:["cotton","cotton blend","polyester","linen","elastane blend","poly blend"],style:["loose fit","regular fit","relaxed fit","slim fit","checks","plain","printed","self-design","textured","knitted"],color:["grey","brown","black","navy blue","purple","dark green","red","orange","light grey","light blue","green","beige","pink","olive","cream","yellow","mustard","white"],price:["499","999","899","1499","1999"]},u=["cargo-pants","linen-pants","shorts","jeans","trousers","boxers"],[g,S]=n.useState(p),[h,y]=n.useState({}),[x,w]=n.useState({}),{category:L}=E();n.useEffect(()=>{(()=>{u.includes(L)?S(o=>({...o,...m})):S(L==="trending"?o=>({...o,...I}):o=>({...o,...p}))})()},[L]);const b=(t,o)=>{t.target.checked?y(r=>({...r,[o]:[...r[o]||[],t.target.name]})):y(r=>{var c;return{...r,[o]:(c=r[o])==null?void 0:c.filter(s=>s!==t.target.name)}})};n.useEffect(()=>{if(Object.keys(h).length!==0){const t=new URLSearchParams;for(const[o,r]of Object.entries(h))r.length>0?r.forEach(c=>{t.append(`${o}`,c)}):t.delete(`${o}`);l(t)}},[h]);const F=(t,o,r)=>{w(c=>({...c,[o]:r})),t.target.scrollIntoView({behavior:"smooth"})};return n.useEffect(()=>{window.scrollTo(0,0)},[x]),e.jsx("div",{className:"filter-sec",ref:P,children:e.jsxs(i,{className:"filterBox",children:[Object.entries(g).map(([t,o])=>e.jsxs(i,{className:"Box",children:[e.jsxs(i,{className:"box-icon-con",children:[e.jsx(v,{title:t,className:"box-title"}),x[t]?e.jsx(T,{onClick:r=>F(r,t,!1)},`${t}_minus`):e.jsx(z,{onClick:r=>F(r,t,!0)},`${t}_plus`)]}),x[t]?e.jsx(i,{className:"sub-box",children:o.map((r,c)=>{var s;return e.jsxs(i,{children:[e.jsx(X,{type:"checkbox",checked:!!((s=h[t])!=null&&s.includes(r)),id:r,name:`${r}`,onChange:d=>b(d,t)}),e.jsx("label",{htmlFor:r,children:r})]},`${c}_${t}`)})}):null]},`${t}_tfgf`)),N&&e.jsxs(i,{className:"filter-button",children:[e.jsx("button",{type:"button",onClick:j,children:"close"}),e.jsx("button",{type:"button",onClick:j,children:"apply"})]})]})})}),G=D;function Q(){const{category:l}=E(),{pathname:N}=A();n.useEffect(()=>{window.scrollTo(0,0)},[N]);const[j,P]=n.useState(""),[p,m]=n.useState(null),[I,u]=n.useState(!0),[g,S]=n.useState(window.innerWidth<=786),[h,y]=n.useState(!1),[x,w]=n.useState(!1),L=n.useRef(null),[b,F]=R(),{accessToken:t,setAccessToken:o}=M();n.useEffect(()=>{const s=["topwear","bottomwear","trending"],d=async()=>{try{u(!0);const a=H(l),k=await fetch(`https://looks.akash-pathak.xyz/api/category?category=${a}`),{categoryValue:C}=await k.json();C&&P(C[0]._id)}catch(a){console.log("error",a)}},f=async()=>{try{u(!0);const a=await fetch("https://looks.akash-pathak.xyz/api/product/"),k=await a.json();if(a.status===200&&l!=="trending"){const C=k.products.filter($=>$.categoryId.subCategory===l);m(C),u(!1)}else{const C=k.products.filter($=>$.categoryId.trending);m(C),u(!1)}}catch(a){console.log("error , ",a),u(!1)}};s.includes(l)?s.includes(l)&&f():d()},[l]),n.useEffect(()=>{b&&(async()=>{try{const d=["topwear","bottomwear"];let f;if(b&&(f=b?b.toString():null),j||d.includes(l)||l==="trending"){const a=await fetch(`https://looks.akash-pathak.xyz/api/product/filter?categoryId=${j}&subCategory=${l}&${f?f+"&":""}`),k=await a.json();a.status===200?(m(k),u(!1)):a.status===404&&u(!1)}}catch(d){console.log("error:",d),u(!1)}})()},[b,j,l]),n.useEffect(()=>{const s=()=>{S(window.innerWidth<=786)};return window.addEventListener("resize",s),()=>{window.removeEventListener("resize",s)}},[]);const r=()=>{y(!1)},c=s=>{m(s==="ascending"?d=>[...d].sort((f,a)=>f.price-a.price):d=>[...d].sort((f,a)=>a.price-f.price)),p&&w(!1)};return n.useEffect(()=>{!t&&localStorage.getItem("userAccessToken")&&o(localStorage.getItem("userAccessToken"))},[t,o]),n.useEffect(()=>{if((x||h)&&g)return document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}},[g,x,h]),e.jsx(i,{className:"product-list-container",children:I?e.jsx(_,{height:"100vh",width:"100%"}):e.jsxs(i,{className:"productList",children:[g&&!h&&e.jsxs(i,{className:"productList-icon-con",children:[e.jsxs(i,{children:[e.jsx(q,{className:"productList-icon",onClick:()=>w(s=>!s)}),e.jsx("h1",{onClick:()=>w(s=>!s),children:"SORT"})]}),e.jsx("div",{className:"line"}),e.jsxs(i,{children:[e.jsx(O,{className:"productList-icon",onClick:()=>y(s=>!s)}),e.jsx("h1",{onClick:()=>y(s=>!s),children:"FILTER"})]})]}),(!g||h)&&e.jsx(i,{className:"filterCon",children:e.jsx(G,{ref:L,isMobile:g,hideFilter:r,className:"filter",setSearchParams:F})}),g&&x&&e.jsx(i,{className:"sort-con",children:e.jsxs(i,{className:"sort",children:[e.jsx("h2",{onClick:()=>c("descending"),children:"Price : High to Low"}),e.jsx("h2",{onClick:()=>c("ascending"),children:"Price : Low to High"}),e.jsx("button",{onClick:()=>w(!1),children:"go back"})]})}),p&&p.length>0?e.jsx(i,{className:"product-column",children:p.map(s=>e.jsx(B,{data:s,route:`/product/${V(s.name)}`},s._id))}):e.jsxs(i,{className:"product-list-error",children:[e.jsx("h2",{children:"nothing to show"}),e.jsx(W,{to:"/",className:"product-list-link",children:e.jsx("h2",{children:"Go to Home page"})})]})]})})}export{Q as default};
