import{u as g,r as n,g as C,h as p,j as e,C as o,i as A,L as S,n as r}from"./index-DdXbiFkB.js";import{A as N}from"./index-D95-s8ii.js";function $(){const{accessToken:l}=g(),[c,d]=n.useState([]),[h,f]=n.useState({}),{userInfo:a,setUserInfo:j}=C(),{setCartInfo:u,cartInfo:b}=p();n.useEffect(()=>{a&&Object.keys(a).length!==0&&(console.log(a.wishlist),d(a.wishlist))},[a]);const m=async s=>{try{const t=await fetch("http://localhost:3000/api/user/",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify({wishlistId:s,wishlistAction:"delete"})}),i=await t.json();t.status===200&&(j(i.userData),r.success("Product removed from wishlist"))}catch(t){r.error("error : ",t)}},x=async(s,t)=>{try{if(t){const i=await fetch("http://localhost:3000/api/cart/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify({productId:s,size:t})}),y=await i.json();i.status===200&&(u(y.cart),await m(s))}else r.error("please select a size")}catch(i){r.error("error : ",i)}},w=(s,t)=>{f(i=>({...i,[t]:s.target.value}))};return n.useEffect(()=>{window.scrollTo(0,0)},[]),e.jsxs(o,{className:"user-address-box ",children:[e.jsx(A,{}),c.length>0?c.map(s=>e.jsxs(o,{className:"wishlist-con",children:[e.jsx(N,{onClick:()=>m(s._id),className:"wishlist-icon"}),e.jsx(o,{className:"wishlist-img",children:e.jsx("img",{src:`${s==null?void 0:s.productImgUrls[0]}`,alt:`${s.name}`})}),e.jsx("h2",{children:s.name}),e.jsx("h3",{children:s.price}),e.jsxs("select",{value:h[s._id],onChange:t=>w(t,s._id),name:"size",children:[e.jsx("option",{value:"",children:"select size"}),s.sizes.map((t,i)=>e.jsx("option",{value:t,children:t},`${i}`))]}),e.jsx("button",{type:"button",onClick:()=>x(s._id,h[s._id]),className:"wishlist-button",children:"Add to cart"})]},`${s._id}`)):e.jsxs(o,{className:"wishlist-con2",children:[e.jsx("h1",{children:"Your wishlist is empty"}),e.jsx("h2",{children:"Add items that you like to your wishlist. Review them anytime and easily move them to the bag."}),e.jsx(S,{to:"/",className:"link-con",children:"Continue Shopping"})]})]})}export{$ as default};
