import{r as n,b as E,j as e,C as c,T as v,F as T,d as X,e as A,f as R,g as z,u as M,S as _,h as O,c as V,L as W}from"./index-Npg09nsS.js";import{P as B,s as H}from"./slugToStr-CqHM6mQZ.js";import{C as q}from"./index-J0F6CvdC.js";const D=n.forwardRef(({setSearchParams:a,isMobile:N,hideFilter:j},P)=>{const p={sizes:["S","M","L","XL","XXL"],material:["cotton","cotton blend","polyester","linen"],style:["checks","plain","printed","self-design","textured","knitted"],color:["grey","brown","black","navy blue","purple","dark green","red","orange","light grey","light blue","green","beige","pink","olive","cream","yellow","mustard","white"],price:["499","999","899","1499","1999"]},m={sizes:["S","M","L","XL","XXL"],material:["cotton","cotton blend","polyester","linen","elastane blend","poly blend"],style:["loose fit","regular fit","relaxed fit","slim fit"],color:["grey","brown","black","navy blue","purple","dark green","red","orange","light grey","light blue","green","beige","pink","olive","cream","yellow","mustard","white"],price:["499","999","899","1499","1999"]},I={sizes:["S","M","L","XL","XXL"],material:["cotton","cotton blend","polyester","linen","elastane blend","poly blend"],style:["loose fit","regular fit","relaxed fit","slim fit","checks","plain","printed","self-design","textured","knitted"],color:["grey","brown","black","navy blue","purple","dark green","red","orange","light grey","light blue","green","beige","pink","olive","cream","yellow","mustard","white"],price:["499","999","899","1499","1999"]},u=["cargo-pants","linen-pants","shorts","jeans","trousers","boxers"],[g,L]=n.useState(p),[h,w]=n.useState({}),[b,y]=n.useState({}),{category:k}=E();n.useEffect(()=>{(()=>{u.includes(k)?L(o=>({...o,...m})):L(k==="trending"?o=>({...o,...I}):o=>({...o,...p}))})()},[k]);const x=(t,o)=>{t.target.checked?w(r=>({...r,[o]:[...r[o]||[],t.target.name]})):w(r=>{var l;return{...r,[o]:(l=r[o])==null?void 0:l.filter(s=>s!==t.target.name)}})};n.useEffect(()=>{if(Object.keys(h).length!==0){const t=new URLSearchParams;for(const[o,r]of Object.entries(h))r.length>0?r.forEach(l=>{t.append(`${o}`,l)}):t.delete(`${o}`);a(t)}},[h]);const F=(t,o,r)=>{y(l=>({...l,[o]:r})),t.target.scrollIntoView({behavior:"smooth"})};return n.useEffect(()=>{window.scrollTo(0,0)},[b]),e.jsx("div",{className:"filter-sec",ref:P,children:e.jsxs(c,{className:"filterBox",children:[Object.entries(g).map(([t,o])=>e.jsxs(c,{className:"Box",children:[e.jsxs(c,{className:"box-icon-con",children:[e.jsx(v,{title:t,className:"box-title"}),b[t]?e.jsx(T,{onClick:r=>F(r,t,!1)},`${t}_minus`):e.jsx(X,{onClick:r=>F(r,t,!0)},`${t}_plus`)]}),b[t]?e.jsx(c,{className:"sub-box",children:o.map((r,l)=>{var s;return e.jsxs(c,{children:[e.jsx(A,{type:"checkbox",checked:!!((s=h[t])!=null&&s.includes(r)),id:r,name:`${r}`,onChange:d=>x(d,t)}),e.jsx("label",{htmlFor:r,children:r})]},`${l}_${t}`)})}):null]},`${t}_tfgf`)),N&&e.jsxs(c,{className:"filter-button",children:[e.jsx("button",{type:"button",onClick:j,children:"close"}),e.jsx("button",{type:"button",onClick:j,children:"apply"})]})]})})}),G=D;function Q(){const{category:a}=E(),{pathname:N}=R();n.useEffect(()=>{window.scrollTo(0,0)},[N]);const[j,P]=n.useState(""),[p,m]=n.useState(null),[I,u]=n.useState(!0),[g,L]=n.useState(window.innerWidth<=786),[h,w]=n.useState(!1),[b,y]=n.useState(!1),k=n.useRef(null),[x,F]=z(),{accessToken:t,setAccessToken:o}=M();n.useEffect(()=>{const s=["topwear","bottomwear","trending"],d=async()=>{try{u(!0);const i=H(a),C=await fetch(`http://192.168.0.104:3000/api/category?category=${i}`),{categoryValue:S}=await C.json();S&&P(S[0]._id)}catch(i){console.log("error",i)}},f=async()=>{try{u(!0);const i=await fetch("http://192.168.0.104:3000/api/product/"),C=await i.json();if(i.status===200&&a!=="trending"){const S=C.products.filter($=>$.categoryId.subCategory===a);m(S),u(!1)}else{const S=C.products.filter($=>$.categoryId.trending);m(S),u(!1)}}catch(i){console.log("error , ",i),u(!1)}};s.includes(a)?s.includes(a)&&f():d()},[a]),n.useEffect(()=>{x&&(async()=>{try{const d=["topwear","bottomwear"];let f;if(x&&(f=x?x.toString():null),j||d.includes(a)||a==="trending"){const i=await fetch(`http://192.168.0.104:3000/api/product/filter?categoryId=${j}&subCategory=${a}&${f?f+"&":""}`),C=await i.json();i.status===200?(m(C),u(!1)):i.status===404&&u(!1)}}catch(d){console.log("error:",d),u(!1)}})()},[x,j,a]),n.useEffect(()=>{const s=()=>{L(window.innerWidth<=786)};return window.addEventListener("resize",s),()=>{window.removeEventListener("resize",s)}},[]);const r=()=>{w(!1)},l=s=>{m(s==="ascending"?d=>[...d].sort((f,i)=>f.price-i.price):d=>[...d].sort((f,i)=>i.price-f.price)),p&&y(!1)};return n.useEffect(()=>{!t&&localStorage.getItem("userAccessToken")&&o(localStorage.getItem("userAccessToken"))},[t,o]),n.useEffect(()=>{if((b||h)&&g)return document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}},[g,b,h]),e.jsx(c,{className:"product-list-container",children:I?e.jsx(_,{height:"100vh",width:"100%"}):e.jsxs(c,{className:"productList",children:[g&&!h&&e.jsxs(c,{className:"productList-icon-con",children:[e.jsxs(c,{children:[e.jsx(q,{className:"productList-icon",onClick:()=>y(s=>!s)}),e.jsx("h1",{onClick:()=>y(s=>!s),children:"SORT"})]}),e.jsx("div",{className:"line"}),e.jsxs(c,{children:[e.jsx(O,{className:"productList-icon",onClick:()=>w(s=>!s)}),e.jsx("h1",{onClick:()=>w(s=>!s),children:"FILTER"})]})]}),(!g||h)&&e.jsx(c,{className:"filterCon",children:e.jsx(G,{ref:k,isMobile:g,hideFilter:r,className:"filter",setSearchParams:F})}),g&&b&&e.jsx(c,{className:"sort-con",children:e.jsxs(c,{className:"sort",children:[e.jsx("h2",{onClick:()=>l("descending"),children:"Price : High to Low"}),e.jsx("h2",{onClick:()=>l("ascending"),children:"Price : Low to High"}),e.jsx("button",{onClick:()=>y(!1),children:"go back"})]})}),p&&p.length>0?e.jsx(c,{className:"product-column",children:p.map(s=>e.jsx(B,{data:s,route:`/product/${V(s.name)}`},s._id))}):e.jsxs(c,{className:"product-list-error",children:[e.jsx("h2",{children:"nothing to show"}),e.jsx(W,{to:"/",className:"product-list-link",children:e.jsx("h2",{children:"Go to Home page"})})]})]})})}export{Q as default};
