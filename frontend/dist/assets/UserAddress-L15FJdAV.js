import{G as v,r as a,u as z,j as r,C as h,f as T,_ as d}from"./index-qZzDzbZj.js";import{u as b}from"./UserInfoContext-HTiHrqoD.js";import{A as I}from"./AddressForm-CSpIVcVg.js";import{A as U}from"./index-DZQUvU2G.js";import{C as D}from"./index-DRhMxtQ4.js";function E(n){return v({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"},child:[]},{tag:"circle",attr:{cx:"12",cy:"10",r:"3"},child:[]}]})(n)}function O(){const[n,i]=a.useState({addressLine:"",locality:"",city:"New York",state:"",country:"USA",zipCode:""}),[p,m]=a.useState(null),[f,x]=a.useState(!1),[y,A]=a.useState(!1),[j,k]=a.useState(""),{userInfo:c,setUserInfo:l}=b(),{accessToken:u}=z();a.useEffect(()=>{c&&Object.keys(c).length!==0&&m(c.address)},[c]);const o=()=>{x(t=>!t),i({addressLine:"",locality:"",city:"",state:"",country:"",zipCode:""}),A(!1)},C=async t=>{try{t.preventDefault();const e=await fetch("https://looks.akash-pathak.xyz/api/user/",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${u}`},body:JSON.stringify({address:n,addressAction:"save"})}),s=await e.json();e.status===200&&(l(s.userData),o(),d.success("address created successfully"))}catch(e){console.log("error",e),d.error(`${e}`)}},g=async t=>{try{t.preventDefault();const e=await fetch("https://looks.akash-pathak.xyz/api/user/",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${u}`},body:JSON.stringify({prevAddressId:j,address:n})}),s=await e.json();e.status===200&&(l(s.userData),o(),d.success("address created successfully"))}catch(e){d.error("error : ",e)}},S=t=>Object.entries(t).filter(([s])=>s!=="default"&&s!=="_id").map(([,s])=>s).join(", "),w=async(t,e)=>{try{const s=await fetch("https://looks.akash-pathak.xyz/api/user/",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${u}`},body:JSON.stringify({address:e,addressAction:"delete"})}),$=await s.json();s.status===200&&(d.success("address deleted successfully"),l($.userData))}catch(s){console.log("error",s),d.error("unable to delete!! Please try again")}},N=(t,e)=>{o(),i(s=>({...s,...e})),A(!0),k(e._id)};return a.useEffect(()=>{window.scrollTo(0,0)},[]),r.jsxs(h,{className:"user-address-box",children:[r.jsx(T,{}),!f&&r.jsxs(r.Fragment,{children:[r.jsxs(h,{className:"address-icon-box",children:[r.jsx(E,{onClick:o,className:"address-icon"}),r.jsx("h1",{onClick:o,children:"Add new address"})]}),p&&p.map((t,e)=>r.jsxs(h,{className:"address-icon-box",children:[r.jsx(U,{onClick:s=>w(s,t),className:"address-icon2"}),r.jsx("h4",{className:"address-info",children:S(t)}),r.jsx(D,{className:"edit-button",onClick:s=>N(s,t)})]},`${t.zipCode}_${e}`))]}),f&&r.jsx(I,{handleHideAndShow:o,setAddress:i,saveAddress:y?g:C,addressObj:n,editAddress:y})]})}export{O as default};
