import{r as l,b as v,a as b,c as C,u as L,j as e,C as f,L as h,f as A,v as F,g as P,n}from"./index-DXygbHet.js";import{F as N}from"./Form-D4uF3sec.js";import{T as k}from"./Title-Bbl53n5L.js";import{u as I}from"./SellerAuthContext-BfVxSjJZ.js";function H(){var d,p;const[t,m]=l.useState({email:"",password:""}),[g,c]=l.useState({emailError:"",passwordError:""}),{auth:r}=v(),u=b(),w=((p=(d=C().state)==null?void 0:d.from)==null?void 0:p.pathname)||"/",{setAccessToken:j}=L(),{setSellerToken:x}=I(),i=()=>{m({email:"",password:""}),c({emailError:"",passwordError:""})},E=async()=>{try{const s=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),a=await s.json();s.status===401?n.error(`${a.message}`):s.status===403?n.error(`${a.message}`):s.status===200&&(j(a.accessToken),x(""),u(`${w}`)),i()}catch(s){i(),n.error(`error : ${s}`)}},y=async()=>{try{const s=await fetch("/api/auth/signup",{method:"POST",headers:{"content-Type":"application/json"},body:JSON.stringify(t)}),a=await s.json();s.status===401?n.error(`${a.message}`):s.status===403?n.error(`${a.message}`):u("/account/login"),i()}catch(s){i(),n.error(`error : ${s}`)}},T=(s,a)=>{s===!1&&c(o=>({...o,emailError:"Email must be in format: example@domain.com"})),a===!1&&c(o=>({...o,passwordError:"Password: â‰¥8 chars, A-Z, a-z, 0-9, & !@#$%^&*."}))},S=async s=>{s.preventDefault();try{const a=F(t.email),o=P(t.password);a&&o?r.toLowerCase()==="signup"?await y():r.toLowerCase()==="login"&&await E():T(a,o)}catch(a){console.log("error : ",a)}},$=s=>{m({...t,[s.target.name]:s.target.value})};return l.useEffect(()=>{window.scrollTo(0,0)},[]),e.jsxs(f,{className:r,children:[e.jsx(k,{title:`${r.toUpperCase()} WITH EMAIL`}),e.jsxs(f,{className:"box1",children:[e.jsx(N,{btnTitle:`${r}`,formData:t,handleInput:$,handleForm:S,errors:g,autoComplete:"true"}),r==="signup"?e.jsxs("p",{children:["or already have an account? ",e.jsx(h,{to:"../login",children:"login"})]}):e.jsxs("p",{children:["or don't have an account? ",e.jsx(h,{to:"../signup",children:"signup"})]})]}),e.jsx(A,{})]})}export{H as default};
