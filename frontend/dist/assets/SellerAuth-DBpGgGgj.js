import{r as m,b,a as v,d as A,l as L,u as C,j as a,C as f,L as g,i as P,n as l}from"./index-DFPjqC03.js";import{F}from"./Form-BDjXq8Xm.js";import{T as N}from"./Title-kBGcg9NW.js";import{v as O,a as R,b as V}from"./validate-DD9itGoP.js";import"./InputBox-DHAnGkK3.js";function q(){var p,h;const[t,u]=m.useState({email:"",password:"",role:""}),[w,i]=m.useState({emailError:"",passwordError:"",roleError:""}),{auth:n}=b(),d=v(),E=((h=(p=A().state)==null?void 0:p.from)==null?void 0:h.pathname)||"/seller-dashboard/products",{setSellerToken:x}=L(),{setAccessToken:j}=C(),c=()=>{u({email:"",password:"",role:""}),i({emailError:"",passwordError:"",roleError:""})},y=async r=>{try{const s=await fetch("https://looks.akash-pathak.xyz/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),e=await s.json();s.status===401?l.error(`${e.message}`):s.status===403?l.error(`${e.message}`):s.status===200&&(x(e.accessToken),localStorage.setItem("sellerAccessToken",e.accessToken),j(""),d(`${E}`)),c()}catch(s){c(),l.error(`error : ${s}`)}},S=async r=>{try{const s=await fetch("https://looks.akash-pathak.xyz/api/auth/signup",{method:"POST",headers:{"content-Type":"application/json"},body:JSON.stringify(t)}),e=await s.json();s.status===401?l.error(`${e.message}`):s.status===403?l.error(`${e.message}`):d("/seller/login"),c()}catch(s){c(),l.error(`error : ${s}`)}},T=(r,s,e)=>{r===!1&&i(o=>({...o,emailError:"Email must be in format: example@domain.com"})),s===!1&&i(o=>({...o,passwordError:"Password: â‰¥8 chars, A-Z, a-z, 0-9, & !@#$%^&*."})),e===!1&&i(o=>({...o,roleError:"Please select role"}))},k=async r=>{r.preventDefault();try{const s=O(t.email),e=R(t.password),o=V(t.role);s&&e&&o?n.toLowerCase()==="signup"?await S():n.toLowerCase()==="login"&&await y():T(s,e,o)}catch(s){console.log("error : ",s)}},$=r=>{u({...t,[r.target.name]:r.target.value})};return m.useEffect(()=>{window.scrollTo(0,0)},[]),a.jsxs(f,{className:n,children:[a.jsx(N,{title:`${n.toUpperCase()} AS SELLER`}),a.jsxs(f,{className:"box1",children:[a.jsx(F,{btnTitle:`${n}`,formData:t,handleInput:$,handleForm:k,errors:w,autoComplete:"true",SellerAuth:!0}),n==="signup"?a.jsxs("p",{children:["or already have an account? ",a.jsx(g,{to:"../login",children:"login"})]}):a.jsxs("p",{children:["or don't have an account? ",a.jsx(g,{to:"../signup",children:"signup"})]})]}),a.jsx(P,{})]})}export{q as default};
