import{u as g,r as n,g as k,h as p,j as e,C as o,i as C,L as z,n as r}from"./index-DFPjqC03.js";import{A}from"./index-ClR5zsex.js";function v(){const{accessToken:l}=g(),[c,d]=n.useState([]),[h,f]=n.useState({}),{userInfo:a,setUserInfo:j}=k(),{setCartInfo:x,cartInfo:S}=p();n.useEffect(()=>{a&&Object.keys(a).length!==0&&(console.log(a.wishlist),d(a.wishlist))},[a]);const m=async s=>{try{const t=await fetch("https://looks.akash-pathak.xyz/api/user/",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify({wishlistId:s,wishlistAction:"delete"})}),i=await t.json();t.status===200&&(j(i.userData),r.success("Product removed from wishlist"))}catch(t){r.error("error : ",t)}},u=async(s,t)=>{try{if(t){const i=await fetch("https://looks.akash-pathak.xyz/api/cart/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify({productId:s,size:t})}),w=await i.json();i.status===200&&(x(w.cart),await m(s))}else r.error("please select a size")}catch(i){r.error("error : ",i)}},y=(s,t)=>{f(i=>({...i,[t]:s.target.value}))};return n.useEffect(()=>{window.scrollTo(0,0)},[]),e.jsxs(o,{className:"user-address-box ",children:[e.jsx(C,{}),c.length>0?c.map(s=>e.jsxs(o,{className:"wishlist-con",children:[e.jsx(A,{onClick:()=>m(s._id),className:"wishlist-icon"}),e.jsx(o,{className:"wishlist-img",children:e.jsx("img",{src:`${s==null?void 0:s.productImgUrls[0]}`,alt:`${s.name}`})}),e.jsx("h2",{children:s.name}),e.jsx("h3",{children:s.price}),e.jsxs("select",{value:h[s._id],onChange:t=>y(t,s._id),name:"size",children:[e.jsx("option",{value:"",children:"select size"}),s.sizes.map((t,i)=>e.jsx("option",{value:t,children:t},`${i}`))]}),e.jsx("button",{type:"button",onClick:()=>u(s._id,h[s._id]),className:"wishlist-button",children:"Add to cart"})]},`${s._id}`)):e.jsxs(o,{className:"wishlist-con2",children:[e.jsx("h1",{children:"Your wishlist is empty"}),e.jsx("h2",{children:"Add items that you like to your wishlist. Review them anytime and easily move them to the bag."}),e.jsx(z,{to:"/",className:"link-con",children:"Continue Shopping"})]})]})}export{v as default};
