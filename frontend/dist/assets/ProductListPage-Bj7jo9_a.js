import{r,b as E,j as e,C as n,F as T,c as z,d as R,e as v,u as A,S as O,f as _,L as V}from"./index-DFPjqC03.js";import{P as W,s as M}from"./slugToStr-Cxq3i2fw.js";import{T as B}from"./Title-kBGcg9NW.js";import{I as H}from"./InputBox-DHAnGkK3.js";import{c as X}from"./createSlug-_5_DawpL.js";import{C as q}from"./index-PsAq3_pG.js";const D=r.forwardRef(({setSearchParams:u,isMobile:N,hideFilter:f},F)=>{const g={sizes:["S","M","L","XL","XXL"],material:["cotton","cotton blend","polyester","linen"],style:["checks","plain","printed","self-design","textured","geometric"],color:["grey","blue","brown","black","navy","purple","dark green","red","orange","light grey","light blue","green","beige","pink","olive","cream"],price:[499,999,1499,1999,899]},p={sizes:["28","30","32","34","36","40"],material:["cotton","cotton blend","polyster","linen","linen blend","poly blend"],style:["loose fit","regular fit","relaxed fit","slim fit"]},L=["trouser","jeans","joggers","shorts"],[h,m]=r.useState(g),[C,S]=r.useState({}),[x,P]=r.useState({}),{category:j}=E();r.useEffect(()=>{(()=>{L.includes(j)?m(c=>({...c,...p})):m(c=>({...c,...g}))})()},[j]);const I=(s,c)=>{s.target.checked?S(t=>({...t,[c]:[...t[c]||[],s.target.name]})):S(t=>{var l;return{...t,[c]:(l=t[c])==null?void 0:l.filter(y=>y!==s.target.name)}})};r.useEffect(()=>{if(Object.keys(C).length!==0){const s=new URLSearchParams;for(const[c,t]of Object.entries(C))t.length>0?t.forEach(l=>{s.append(`${c}`,l)}):s.delete(`${c}`);u(s)}},[C]);const b=(s,c,t)=>{P(l=>({...l,[c]:t})),s.target.scrollIntoView({behavior:"smooth"})};return r.useEffect(()=>{window.scrollTo(0,0)},[x]),e.jsx("div",{className:"filter-sec",ref:F,children:e.jsxs(n,{className:"filterBox",children:[Object.entries(h).map(([s,c])=>e.jsxs(n,{className:"Box",children:[e.jsxs(n,{className:"box-icon-con",children:[e.jsx(B,{title:s,className:"box-title"}),x[s]?e.jsx(T,{onClick:t=>b(t,s,!1)},`${s}_minus`):e.jsx(z,{onClick:t=>b(t,s,!0)},`${s}_plus`)]}),x[s]?e.jsx(n,{className:"sub-box",children:c.map((t,l)=>e.jsxs(n,{children:[e.jsx(H,{type:"checkbox",id:t,name:`${t}`,onChange:y=>I(y,s)}),e.jsx("label",{htmlFor:t,children:t})]},`${l}_${s}`))}):null]},`${s}_tfgf`)),N&&e.jsxs(n,{className:"filter-button",children:[e.jsx("button",{type:"button",onClick:f,children:"close"}),e.jsx("button",{type:"button",onClick:f,children:"apply"})]})]})})}),G=D;function ee(){const{category:u}=E(),{pathname:N}=R();r.useEffect(()=>{window.scrollTo(0,0)},[N]);const[f,F]=r.useState(""),[g,p]=r.useState(null),[L,h]=r.useState(!0),[m,C]=r.useState(window.innerWidth<700),[S,x]=r.useState(!1),[P,j]=r.useState(!1),I=r.useRef(null),[b,s]=v(),{accessToken:c,setAccessToken:t}=A();r.useEffect(()=>{const o=["topwear","bottomwear","trending"],i=async()=>{try{h(!0);const a=M(u),k=await fetch(`https://looks.akash-pathak.xyz/api/category?category=${a}`),{categoryValue:w}=await k.json();w&&(console.log(w),F(w[0]._id))}catch(a){console.log("error",a)}},d=async()=>{try{h(!0);const a=await fetch("https://looks.akash-pathak.xyz/api/product/"),k=await a.json();if(a.status===200&&u!=="trending"){const w=k.products.filter($=>$.categoryId.subCategory===u);p(w),h(!1)}else{const w=k.products.filter($=>$.categoryId.trending);p(w),h(!1)}}catch(a){console.log("error , ",a)}};o.includes(u)?o.includes(u)&&d():i()},[u]),r.useEffect(()=>{(async()=>{try{let i;if(b&&(i=b?b.toString():null),f){console.log(f);const d=await fetch(`https://looks.akash-pathak.xyz/api/product/filter?${i?i+"&":""}categoryId=${f}`),a=await d.json();d.status===200?(console.log(a),p(a),h(!1)):d.status===404&&h(!1)}}catch(i){console.log("error:",i)}})()},[b,f]),r.useEffect(()=>{const o=()=>{C(window.innerWidth<700)};return window.addEventListener("resize",o),()=>{window.removeEventListener("resize",o)}},[]);const l=()=>{x(!1)},y=o=>{p(o==="ascending"?i=>[...i].sort((d,a)=>d.price-a.price):i=>[...i].sort((d,a)=>a.price-d.price)),g&&j(!1)};return r.useEffect(()=>{!c&&localStorage.getItem("userAccessToken")&&t(localStorage.getItem("userAccessToken"))},[c,t]),e.jsx(n,{className:"product-list-container",children:L?e.jsx(O,{}):e.jsx(e.Fragment,{children:g&&g.length>0?e.jsxs(n,{className:"productList",children:[m&&!S&&e.jsxs(n,{className:"productList-icon-con",children:[e.jsxs(n,{children:[e.jsx(q,{className:"productList-icon",onClick:()=>j(o=>!o)}),e.jsx("h1",{onClick:()=>j(o=>!o),children:"SORT"})]}),e.jsx("div",{className:"line"}),e.jsxs(n,{children:[e.jsx(_,{className:"productList-icon",onClick:()=>x(o=>!o)}),e.jsx("h1",{onClick:()=>x(o=>!o),children:"FILTER"})]})]}),(!m||S)&&e.jsx(n,{className:"filterCon",children:e.jsx(G,{ref:I,isMobile:m,hideFilter:l,className:"filter",setSearchParams:s})}),m&&P&&e.jsx(n,{className:"sort-con",children:e.jsxs(n,{className:"sort",children:[e.jsx("h2",{onClick:()=>y("descending"),children:"Price : High to Low"}),e.jsx("h2",{onClick:()=>y("ascending"),children:"Price : Low to High"}),e.jsx("button",{onClick:()=>j(!1),children:"go back"})]})}),e.jsx(n,{className:"product-column",children:g.map(o=>e.jsx(W,{data:o,route:`/product/${X(o.name)}`},o._id))})]}):e.jsxs(n,{className:"product-list-error",children:[e.jsx("h2",{children:"nothing to show"}),e.jsx(V,{to:"/",className:"product-list-link",children:e.jsx("h2",{children:"Go to Home page"})})]})})})}export{ee as default};
