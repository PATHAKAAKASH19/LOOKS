import{r as l,b as S,a as v,f as b,u as A,s as C,j as e,C as h,T as L,L as f,n as F,v as P,t as I,o as n}from"./index-Dw_2fx3G.js";import{F as N}from"./Form-D9536gZm.js";function V(){var p,d;const[t,u]=l.useState({email:"",password:""}),[g,c]=l.useState({emailError:"",passwordError:""}),{auth:o}=S(),m=v(),w=((d=(p=b().state)==null?void 0:p.from)==null?void 0:d.pathname)||"/",{setAccessToken:x}=A(),{setSellerToken:j}=C(),i=()=>{u({email:"",password:""}),c({emailError:"",passwordError:""})},y=async()=>{try{const s=await fetch("https://looks.akash-pathak.xyz/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),a=await s.json();s.status===401?n.error(`${a.message}`):s.status===403?n.error(`${a.message}`):s.status===200&&(x(a.accessToken),localStorage.setItem("userAccessToken",a.accessToken),j(""),m(`${w}`)),i()}catch(s){i(),n.error(`error : ${s}`)}},E=async()=>{try{const s=await fetch("https://looks.akash-pathak.xyz/api/auth/signup",{method:"POST",headers:{"content-Type":"application/json"},body:JSON.stringify(t)}),a=await s.json();s.status===401?n.error(`${a.message}`):s.status===403?n.error(`${a.message}`):m("/account/login"),i()}catch(s){i(),n.error(`error : ${s}`)}},T=(s,a)=>{s===!1&&c(r=>({...r,emailError:"Email must be in format: example@domain.com"})),a===!1&&c(r=>({...r,passwordError:"Password: â‰¥8 chars, A-Z, a-z, 0-9, & !@#$%^&*."}))},k=async s=>{s.preventDefault();try{const a=P(t.email),r=I(t.password);a&&r?o.toLowerCase()==="signup"?await E():o.toLowerCase()==="login"&&await y():T(a,r)}catch(a){console.log("error : ",a)}},$=s=>{u({...t,[s.target.name]:s.target.value})};return l.useEffect(()=>{window.scrollTo(0,0)},[]),e.jsxs(h,{className:o,children:[e.jsx(L,{title:`${o.toUpperCase()} WITH EMAIL`}),e.jsxs(h,{className:"box1",children:[e.jsx(N,{btnTitle:`${o}`,formData:t,handleInput:$,handleForm:k,errors:g,autoComplete:"true"}),o==="signup"?e.jsxs("p",{children:["or already have an account? ",e.jsx(f,{to:"../login",children:"login"})]}):e.jsxs("p",{children:["or don't have an account? ",e.jsx(f,{to:"../signup",children:"signup"})]})]}),e.jsx(F,{})]})}export{V as default};
