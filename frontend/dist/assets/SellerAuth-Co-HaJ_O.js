import{r as m,a as b,f as A,c as L,l as C,u as P,j as r,C as f,L as g,i as k,n as l}from"./index-DdXbiFkB.js";import{F}from"./Form-CMwXAaW5.js";import{T as N}from"./Title-XAzlc8PW.js";import{v as O,a as R,b as V}from"./validate-DD9itGoP.js";import"./InputBox-CRXJ9-E-.js";function q(){var p,h;const[t,u]=m.useState({email:"",password:"",role:""}),[w,i]=m.useState({emailError:"",passwordError:"",roleError:""}),{auth:n}=b(),d=A(),E=((h=(p=L().state)==null?void 0:p.from)==null?void 0:h.pathname)||"/seller-dashboard/products",{setSellerToken:j}=C(),{setAccessToken:x}=P(),c=()=>{u({email:"",password:"",role:""}),i({emailError:"",passwordError:"",roleError:""})},S=async a=>{try{const e=await fetch("http://localhost:3000/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),s=await e.json();e.status===401?l.error(`${s.message}`):e.status===403?l.error(`${s.message}`):e.status===200&&(j(s.accessToken),localStorage.setItem("sellerAccessToken",s.accessToken),x(""),d(`${E}`)),c()}catch(e){c(),l.error(`error : ${e}`)}},y=async a=>{try{const e=await fetch("http://localhost:3000/api/auth/signup",{method:"POST",headers:{"content-Type":"application/json"},body:JSON.stringify(t)}),s=await e.json();e.status===401?l.error(`${s.message}`):e.status===403?l.error(`${s.message}`):d("/seller/login"),c()}catch(e){c(),l.error(`error : ${e}`)}},T=(a,e,s)=>{a===!1&&i(o=>({...o,emailError:"Email must be in format: example@domain.com"})),e===!1&&i(o=>({...o,passwordError:"Password: â‰¥8 chars, A-Z, a-z, 0-9, & !@#$%^&*."})),s===!1&&i(o=>({...o,roleError:"Please select role"}))},$=async a=>{a.preventDefault();try{const e=O(t.email),s=R(t.password),o=V(t.role);e&&s&&o?n.toLowerCase()==="signup"?await y():n.toLowerCase()==="login"&&await S():T(e,s,o)}catch(e){console.log("error : ",e)}},v=a=>{u({...t,[a.target.name]:a.target.value})};return m.useEffect(()=>{window.scrollTo(0,0)},[]),r.jsxs(f,{className:n,children:[r.jsx(N,{title:`${n.toUpperCase()} AS SELLER`}),r.jsxs(f,{className:"box1",children:[r.jsx(F,{btnTitle:`${n}`,formData:t,handleInput:v,handleForm:$,errors:w,autoComplete:"true",SellerAuth:!0}),n==="signup"?r.jsxs("p",{children:["or already have an account? ",r.jsx(g,{to:"../login",children:"login"})]}):r.jsxs("p",{children:["or don't have an account? ",r.jsx(g,{to:"../signup",children:"signup"})]})]}),r.jsx(k,{})]})}export{q as default};
