import{r,b as E,j as e,C as n,F as T,c as z,d as R,e as v,u as A,S as O,f as _,L as V}from"./index-BQJw1z1n.js";import{P as W,s as M}from"./slugToStr-DxRyk3i5.js";import{T as B}from"./Title-YRACG9t2.js";import{I as H}from"./InputBox-fKD-P2jW.js";import{c as X}from"./createSlug-_5_DawpL.js";import{C as q}from"./index-Df7J5bN8.js";const D=r.forwardRef(({setSearchParams:u,isMobile:N,hideFilter:b},F)=>{const f={sizes:["S","M","L","XL","XXL"],material:["cotton","cotton blend","polyester","linen"],style:["checks","plain","printed","self-design","textured","geometric"],color:["grey","blue","brown","black","navy","purple","dark green","red","orange","light grey","light blue","green","beige","pink","olive","cream"],price:[499,999,1499,1999,899]},p={sizes:["28","30","32","34","36","40"],material:["cotton","cotton blend","polyster","linen","linen blend","poly blend"],style:["loose fit","regular fit","relaxed fit","slim fit"]},L=["trouser","jeans","joggers","shorts"],[h,g]=r.useState(f),[C,S]=r.useState({}),[m,P]=r.useState({}),{category:x}=E();r.useEffect(()=>{(()=>{L.includes(x)?g(c=>({...c,...p})):g(c=>({...c,...f}))})()},[x]);const I=(s,c)=>{s.target.checked?S(t=>({...t,[c]:[...t[c]||[],s.target.name]})):S(t=>{var i;return{...t,[c]:(i=t[c])==null?void 0:i.filter(w=>w!==s.target.name)}})};r.useEffect(()=>{if(Object.keys(C).length!==0){const s=new URLSearchParams;for(const[c,t]of Object.entries(C))t.length>0?t.forEach(i=>{s.append(`${c}`,i)}):s.delete(`${c}`);u(s)}},[C]);const j=(s,c,t)=>{P(i=>({...i,[c]:t})),s.target.scrollIntoView({behavior:"smooth"})};return r.useEffect(()=>{window.scrollTo(0,0)},[m]),e.jsx("div",{className:"filter-sec",ref:F,children:e.jsxs(n,{className:"filterBox",children:[Object.entries(h).map(([s,c])=>e.jsxs(n,{className:"Box",children:[e.jsxs(n,{className:"box-icon-con",children:[e.jsx(B,{title:s,className:"box-title"}),m[s]?e.jsx(T,{onClick:t=>j(t,s,!1)},`${s}_minus`):e.jsx(z,{onClick:t=>j(t,s,!0)},`${s}_plus`)]}),m[s]?e.jsx(n,{className:"sub-box",children:c.map((t,i)=>e.jsxs(n,{children:[e.jsx(H,{type:"checkbox",id:t,name:`${t}`,onChange:w=>I(w,s)}),e.jsx("label",{htmlFor:t,children:t})]},`${i}_${s}`))}):null]},`${s}_tfgf`)),N&&e.jsxs(n,{className:"filter-button",children:[e.jsx("button",{type:"button",onClick:b,children:"close"}),e.jsx("button",{type:"button",onClick:b,children:"apply"})]})]})})}),G=D;function ee(){const{category:u}=E(),{pathname:N}=R();r.useEffect(()=>{window.scrollTo(0,0)},[N]);const[b,F]=r.useState(""),[f,p]=r.useState(null),[L,h]=r.useState(!0),[g,C]=r.useState(window.innerWidth<700),[S,m]=r.useState(!1),[P,x]=r.useState(!1),I=r.useRef(null),[j,s]=v(),{accessToken:c,setAccessToken:t}=A();r.useEffect(()=>{const o=["topwear","bottomwear","trending"],l=async()=>{try{h(!0);const a=M(u),k=await fetch(`https://looks.akash-pathak.xyz/api/category?category=${a}`),{categoryValue:y}=await k.json();y&&F(y[0]._id)}catch(a){console.log("error",a)}},d=async()=>{try{h(!0);const a=await fetch("https://looks.akash-pathak.xyz/api/product/"),k=await a.json();if(a.status===200&&u!=="trending"){const y=k.products.filter($=>$.categoryId.subCategory===u);p(y),h(!1)}else{const y=k.products.filter($=>$.categoryId.trending);p(y),h(!1)}}catch(a){console.log("error , ",a)}};o.includes(u)?o.includes(u)&&d():l()},[u]),r.useEffect(()=>{(async()=>{try{let l;if(j&&(l=j?j.toString():null),b){const d=await fetch(`https://looks.akash-pathak.xyz/api/product/filter?categoryId=${b}&${l}`),a=await d.json();d.status===200?(p(a),h(!1)):d.status===404&&h(!1)}}catch(l){console.log("error:",l)}})()},[j,b]),r.useEffect(()=>{const o=()=>{C(window.innerWidth<700)};return window.addEventListener("resize",o),()=>{window.removeEventListener("resize",o)}},[]);const i=()=>{m(!1)},w=o=>{p(o==="ascending"?l=>[...l].sort((d,a)=>d.price-a.price):l=>[...l].sort((d,a)=>a.price-d.price)),f&&x(!1)};return r.useEffect(()=>{!c&&localStorage.getItem("userAccessToken")&&t(localStorage.getItem("userAccessToken"))},[c,t]),e.jsx(n,{className:"product-list-container",children:L?e.jsx(O,{}):e.jsx(e.Fragment,{children:f&&f.length>0?e.jsxs(n,{className:"productList",children:[g&&!S&&e.jsxs(n,{className:"productList-icon-con",children:[e.jsxs(n,{children:[e.jsx(q,{className:"productList-icon",onClick:()=>x(o=>!o)}),e.jsx("h1",{onClick:()=>x(o=>!o),children:"SORT"})]}),e.jsx("div",{className:"line"}),e.jsxs(n,{children:[e.jsx(_,{className:"productList-icon",onClick:()=>m(o=>!o)}),e.jsx("h1",{onClick:()=>m(o=>!o),children:"FILTER"})]})]}),(!g||S)&&e.jsx(n,{className:"filterCon",children:e.jsx(G,{ref:I,isMobile:g,hideFilter:i,className:"filter",setSearchParams:s})}),g&&P&&e.jsx(n,{className:"sort-con",children:e.jsxs(n,{className:"sort",children:[e.jsx("h2",{onClick:()=>w("descending"),children:"Price : High to Low"}),e.jsx("h2",{onClick:()=>w("ascending"),children:"Price : Low to High"}),e.jsx("button",{onClick:()=>x(!1),children:"go back"})]})}),e.jsx(n,{className:"product-column",children:f.map(o=>e.jsx(W,{data:o,route:`/product/${X(o.name)}`},o._id))})]}):e.jsxs(n,{className:"product-list-error",children:[e.jsx("h2",{children:"nothing to show"}),e.jsx(V,{to:"/",className:"product-list-link",children:e.jsx("h2",{children:"Go to Home page"})})]})})})}export{ee as default};
